<?xml version="1.0" encoding="UTF-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
<!--
****************************************************************************
                    PRONOMBRES CLÍTICOS

Cuando el pronombre proclítico es el reflexivo 'se', y no aparece con un verbo pronominal
, se envía en un chunk aparte con lema 'ref', para que pueda detectarse en el t2x en caso necesario,
para tratar frase impersonales y pasivas reflejas ('se dice que' vs. 'se casa mañana'...).
Cuando sucede lo mismo pero se trata de un pronombre *enclítico*, no se envía aparte, simplemente
se envia el verbo sin el pronombre reflexivo. Así, por ahora, no se puede saber si un pronombre enclítico
'desaparecido' era un pronombre reflexivo aparecido junto con un verbo pronominal o un verbo no pronominal.
Si se quiere empezar a tratar las frase impersonales en el t2x, habría que hacer algo al respecto.



**************************************************************************
-->




  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/><!--Falten els altres np (antroponims) que tenen gen i nbr, revisar regles.-->
      <cat-item tags="np.loc.*"/>
    </def-cat>

     <def-cat n="ant">
      <cat-item tags="np.ant.*"/>
    </def-cat>
     <def-cat n="al">
      <cat-item tags="np.al.*"/>
    </def-cat>
     <def-cat n="cog">
      <cat-item tags="np.cog.*"/>
    </def-cat>
    <def-cat n="llegado">
      <cat-item lemma="llegar" tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="llegar">
      <cat-item lemma="llegar" tags="vblex.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
    </def-cat>
    <def-cat n="adj_pp">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="det"><!--Determinants i predeterminants, van anteposats en català -->
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="predet.*"/>
      <!-- <cat-item tags="num.*"/> -->
    </def-cat>

    <def-cat n="el">
      <cat-item lemma="el" tags="det.def.m.sg"/>
    </def-cat>

    <def-cat n="el_un"><!--afegir-hi tb 'un'? (un 30%). No sé si tb desapareix -->
      <cat-item lemma="el" tags="det.def.m.sg"/>
      <cat-item lemma="uno" tags="det.ind.m.sg"/>
    </def-cat>

 <def-cat n="las">
      <cat-item lemma="el" tags="det.def.f.pl"/>
    </def-cat>

     <def-cat n="horas">
      <cat-item tags="num.time"/>
    </def-cat>

    <def-cat n="majestad">
      <cat-item lemma="su majestad" tags="n.f.sg"/>
      <cat-item lemma="su alteza" tags="n.f.sg"/>
      <cat-item lemma="su alteza real" tags="n.f.sg"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>

    <def-cat n="percent">
      <cat-item tags="num.percent"/>
    </def-cat>

    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="a">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>

    <def-cat n="prpers">
      <cat-item lemma="prpers" tags="prn.*"/>
    </def-cat>
    <def-cat n="prpers_tn">
      <cat-item lemma="prpers" tags="prn.tn.*"/>
    </def-cat>

    <def-cat n="tn_itg_pos"><!--Aquí no hi entren els pronoms personals, caldrà fer-ne un xunc a part. -->
      <cat-item tags="prn.tn.m.*"/>
      <cat-item tags="prn.tn.f.*"/>
      <cat-item tags="prn.tn.mf.*"/>
      <cat-item tags="prn.tn.nt"/>
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="prn.pos.*"/>
    </def-cat>
    
    <def-cat n="enc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>

    <def-cat n="pro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="pro_noref">
      <cat-item tags="prn.pro.p1.*"/>
      <cat-item tags="prn.pro.p2.*"/>
      <cat-item tags="prn.pro.p3.*"/>
    </def-cat>

    <def-cat n="pro_lola">
      <cat-item lemma="lo" tags="prn.pro.p3.nt"/>
      <cat-item lemma="prpers" tags="prn.pro.p3.m.sg"/>
      <cat-item lemma="prpers" tags="prn.pro.p3.f.sg"/>
    </def-cat>
    <def-cat n="enc_lola">
      <cat-item lemma="lo" tags="prn.enc.p3.nt"/>
      <cat-item lemma="prpers" tags="prn.enc.p3.m.sg"/>
      <cat-item lemma="prpers" tags="prn.enc.p3.f.sg"/>
    </def-cat>


    <def-cat n="verb_pronlex" c="verbos con pronombre lexicalizado">      
      <cat-item lemma="pasar# bien" tags="vblex.*"/>    
      <cat-item lemma="pasar# mal" tags="vblex.*"/>
    </def-cat>

    <def-cat n="verb_pronlex_pp" c="verbos con pronombre lexicalizado">      
      <cat-item lemma="pasar# bien" tags="vblex.pp.m.sg"/>    
      <cat-item lemma="pasar# mal" tags="vblex.pp.m.sg"/>
    </def-cat>
    <def-cat n="verb_pronlex_infger" c="verbos con pronombre lexicalizado">      
      <cat-item lemma="pasar# bien" tags="vblex.inf"/>     
      <cat-item lemma="pasar# bien" tags="vblex.ger"/>    
      <cat-item lemma="pasar# mal" tags="vblex.inf"/>     
      <cat-item lemma="pasar# mal" tags="vblex.ger"/>
    </def-cat>
    <def-cat n="verb_pronlex_imp" c="verbos con pronombre lexicalizado">      
      <cat-item lemma="pasar# bien" tags="vblex.imp.*"/>     
      <cat-item lemma="pasar# mal" tags="vblex.imp.*"/>    
    </def-cat>
    <def-cat n="verb_pronlex_ger" c="verbos con pronombre lexicalizado">  
      <cat-item lemma="pasar# bien" tags="vblex.ger"/> 
      <cat-item lemma="pasar# mal" tags="vblex.ger"/>
    </def-cat>

    <def-cat n="verbnm_inf_ger"><!--verb no modal, infinitiu i gerundi -->
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbser.pron.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.pron.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbser.pron.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbhaver.pron.ger"/>
    </def-cat>

    <def-cat n="verbnm_imp"><!--verb no modal, imperatiu -->
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pron.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pron.imp.*"/>
    </def-cat>

    <def-cat n="verbm"><!--verb modal -->
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="verbm_inf_ger"><!--verb modal, infinitiu o gerundi -->
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>

    <def-cat n="haver">
      <cat-item tags="vbhaver.*"/>
    </def-cat>
    <def-cat n="haverinf">
      <cat-item tags="vbhaver.inf"/>
    </def-cat>

 <def-cat n="hay">
      <cat-item tags="vbhaver.cni.p3.sg"/>
      <cat-item tags="vbhaver.fti.p3.sg"/>
      <cat-item tags="vbhaver.fts.p3.sg"/>
      <cat-item tags="vbhaver.ifi.p3.sg"/>
      <cat-item tags="vbhaver.pii.p3.sg"/>
      <cat-item tags="vbhaver.pis.p3.sg"/>
      <cat-item tags="vbhaver.prs.p3.sg"/>
      <cat-item lemma="hay" tags="vblex.*"/>
    </def-cat>

 <def-cat n="hay_lex">
      <cat-item lemma="hay" tags="vblex.*"/>
    </def-cat>

  <def-cat n="estar">
      <cat-item lemma="estar" tags="vblex.cni.*"/>
      <cat-item lemma="estar" tags="vblex.fti.*"/>
      <cat-item lemma="estar" tags="vblex.ifi.*"/>
      <cat-item lemma="estar" tags="vblex.imp.*"/>
      <cat-item lemma="estar" tags="vblex.pii.*"/>
      <cat-item lemma="estar" tags="vblex.pis.*"/>
      <cat-item lemma="estar" tags="vblex.fts.*"/>
      <cat-item lemma="estar" tags="vblex.pri.*"/>
      <cat-item lemma="estar" tags="vblex.prs.*"/>
  </def-cat>

    <def-cat n="verbcj">
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.fts.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.fts.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.fts.*"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
      <cat-item tags="vbmod.cni.*"/>
      <cat-item tags="vbmod.fti.*"/>
      <cat-item tags="vbmod.ifi.*"/>
      <cat-item tags="vbmod.imp.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pis.*"/>
      <cat-item tags="vbmod.fts.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.prs.*"/>
      <cat-item tags="vblex.pron.cni.*"/>
      <cat-item tags="vblex.pron.fti.*"/>
      <cat-item tags="vblex.pron.ifi.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vblex.pron.pii.*"/>
      <cat-item tags="vblex.pron.pis.*"/>
      <cat-item tags="vblex.pron.fts.*"/>
      <cat-item tags="vblex.pron.pri.*"/>
      <cat-item tags="vblex.pron.prs.*"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.pron.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/><!--ATENCIÓ: CANVI -->
    </def-cat>

    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>


    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>

    <def-cat n="preadv">
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="más">
      <cat-item lemma="más" tags="adv"/>
      <cat-item lemma="más" tags="preadv"/>
      <cat-item lemma="más" tags="det.*"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>

    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>

    <def-cat n="no">
      <cat-item lemma="no" tags="adv"/>
    </def-cat>

   <def-cat n="hace">
      <cat-item lemma="hacer" tags="vblex.pri.p3.sg"/>
    </def-cat>

     <def-cat n="periodo">
      <cat-item lemma="año" tags="n.*"/>
      <cat-item lemma="mes" tags="n.*"/>
      <cat-item lemma="semana" tags="n.*"/>
      <cat-item lemma="día" tags="n.*"/>
      <cat-item lemma="hora" tags="n.*"/>
      <cat-item lemma="minuto" tags="n.*"/>
      <cat-item lemma="segundo" tags="n.*"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item lemma="y" tags="cnjcoo"/>
      <cat-item lemma="o" tags="cnjcoo"/>
      <cat-item lemma="pero" tags="cnjcoo"/>
    </def-cat>

     <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
    </def-cat>

    <def-cat n="para">
      <cat-item lemma="para" tags="pr"/>
    </def-cat>

    <def-cat n="de">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>

    <def-cat n="porello">
      <cat-item lemma="por ello" tags="cnjadv"/>
    </def-cat>

    <def-cat n="rel">
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="el_que">
      <cat-item lemma="el que" tags="rel.nn.*"/>
    </def-cat>

    <def-cat n="haber_que">
      <cat-item lemma="haber que" tags="vbmod.*"/>
    </def-cat>

    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

    <def-cat n="coma">
      <cat-item tags="cm"/>
    </def-cat>

    <def-cat n="mes">
      <cat-item lemma="enero" tags="n.m.sg"/>
      <cat-item lemma="febrero" tags="n.m.sg"/>
      <cat-item lemma="marzo" tags="n.m.sg"/>
      <cat-item lemma="abril" tags="n.m.sg"/>
      <cat-item lemma="mayo" tags="n.m.sg"/>
      <cat-item lemma="junio" tags="n.m.sg"/>
      <cat-item lemma="julio" tags="n.m.sg"/>
      <cat-item lemma="agosto" tags="n.m.sg"/>
      <cat-item lemma="septiembre" tags="n.m.sg"/>
      <cat-item lemma="setiembre" tags="n.m.sg"/>
      <cat-item lemma="octubre" tags="n.m.sg"/>
      <cat-item lemma="noviembre" tags="n.m.sg"/>
      <cat-item lemma="diciembre" tags="n.m.sg"/>
    </def-cat>

  </section-def-cats>
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.al"/>	
      <attr-item tags="np.cog"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/>
      <attr-item tags="adj.sint"/>
      <attr-item tags="adj.sint.comp"/>
      <attr-item tags="adj.sint.sup"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>  

    <def-attr n="grau">      
      <attr-item tags="sup"/> 
    </def-attr>

    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>
      <attr-item tags="det.ord"/>
      <attr-item tags="predet"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_num">
      <attr-item tags="num"/>
      <attr-item tags="num.ord"/>
      <attr-item tags="num.percent"/>
      <attr-item tags="num.mon"/>
      <attr-item tags="num.time"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="pron">
      <attr-item tags="pron"/>
    </def-attr>

    <def-attr n="sep">
      <attr-item tags="sep"/>
    </def-attr>

    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
    </def-attr>

    <def-attr n="a_rel">
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.an"/>
      <attr-item tags="rel.adv"/>
    </def-attr>

    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vblex.sep.pp"/>
      <attr-item tags="vbser.sep.pp"/>
      <attr-item tags="vbmod.sep.pp"/>
      <attr-item tags="vaux.pp"/>
      <attr-item tags="vbhaver.pp"/>
    </def-attr>

    <def-attr n="a_prn">
      <attr-item tags="prn"/>
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="subj"/>
      <attr-item tags="obj"/>
      <attr-item tags="tn"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
    </def-attr>
    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>  
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="pri"/>
      <attr-item tags="prs"/>
      <attr-item tags="pres"/>
      <attr-item tags="past"/>
      <attr-item tags="pp"/>
      <attr-item tags="pprs"/>
      <attr-item tags="subs"/>
      <attr-item tags="ger"/>
      <attr-item tags="inf"/>
    </def-attr>



    <def-attr n="neg">
      <attr-item tags="NEG"/>
    </def-attr>  

  </section-def-attrs>
  <section-def-vars>
    <def-var n="nombre" v="&amp;lt;sg&amp;gt;"/>
    <def-var n="genere" v="&amp;lt;m&amp;gt;"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="caseFirstWord"/> 
    <def-var n="caseSecondWord"/>
    <def-var n="lema"/>
    <def-var n="lema_SV"/>
    <def-var n="EOS" v="true"/>
    <def-var n="paraula1"/>
    <def-var n="SVnegatiu"/>
    <def-var n="auxiliar"/>
    <def-var n="adv_adjectiu"/>
    <def-var n="modAdv"/>
    <def-var n="tempsv"/>
    <def-var n="temps_chunk"/>
    <def-var n="pers_chunk"/>
    <def-var n="nbr_chunk"/>
    <def-var n="gen_chunk"/>
    <def-var n="nom_chunk"/>
    <def-var n="verbfinal"/>
    <def-var n="superlatiu1"/>
    <def-var n="superlatiu2"/>
    <def-var n="prepo"/>
    <def-var n="espai"/>
  </section-def-vars>

  <section-def-lists>

    <def-list n="llegar_even">
      <list-item v="afirmar"/>
      <list-item v="decir"/>
      <list-item v="declarar"/>
      <list-item v="proponer"/>
      <list-item v="comparar"/>
      <list-item v="pensar"/>
      <list-item v="insinuar"/>
      <list-item v="exigir"/>
      <list-item v="pedir"/>
      <list-item v="prohibir"/>
      <list-item v="manifestar"/>
    </def-list>

    <def-list n="det_canviant">
      <list-item v="uno"/>
      <list-item v="otro"/>
      <list-item v="poco"/>
      <list-item v="cuánto"/>
      <list-item v="menos"/>
      <list-item v="mucho"/>
      <list-item v="tanto"/>
      <list-item v="demasiado"/>
    </def-list>



 <def-list n="preps_inf">
      <list-item v="so as to"/>
      <list-item v="with a view to"/>
      <list-item v="to"/>
      <list-item v="in order to"/>
    </def-list>

 <def-list n="en_majuscules">
      <list-item v="Monday"/>
      <list-item v="Tuesday"/>
      <list-item v="Wednesday"/>
      <list-item v="Thursday"/>
      <list-item v="Friday"/>
      <list-item v="Saturday"/>
      <list-item v="Sunday"/>
 </def-list>

 <def-list n="añadir_prep_pron" c="verbos a los que hay que añadir preposición cuando llevan pronombre clítico">
   <list-item v="ser# propio"/>
   <list-item v="ser# de gran ayuda"/>
 </def-list>

<def-list n="adv_intercalados">
      <list-item v="siempre"/>
      <list-item v="sólo"/>
      <list-item v="sólamente"/>
      <list-item v="todavía"/>
      <list-item v="aún"/>
      <list-item v="nunca"/>
      <list-item v="muy"/>
      <list-item v="jamás"/>
      <list-item v="también"/>
      <list-item v="tampoco"/>
      <list-item v="ya"/>
      <list-item v="ya no"/>
      <list-item v="pronto"/>
</def-list>


  </section-def-lists>


  <section-def-macros>
    

    <def-macro n="f_bcond" npar="2"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>


    <def-macro n="nombre_nom" npar="1"><!-- per determinar si hi ha hagut canvi de nombre en la traducció. Després d'aquesta macro s'aplica la macro 'canvia_det'. Caldria ajuntar aquesta macro i la 'canvia_det' !!!!!!! -->
      <let>
	<var n="nombre"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="pl_slsg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="sg_slpl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="nombre"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</otherwise>
      </choose> 
    </def-macro>

   




    <def-macro n="canvia_det" npar="2">
      <choose>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="det_canviant"/>
	    </in>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <var n="nombre"/>
		    <lit-tag v="sg_slpl"/>
		  </equal>
		  <and><!--perquè no doni error en casos (errors original) com 'uns arbre' -->
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </and>
		</or>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="some"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="a"/>
		    </get-case-from>
		  </let>
		  <let>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.ind"/>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="other"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="another"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="few"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="little"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="how many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="how much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="fewer"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="less"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="so many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="so much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="too many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too much"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>

	    <when>
	      <test>
		<or>
		  <equal>
		    <var n="nombre"/>
		    <lit-tag v="pl_slsg"/>
		  </equal>
		  <and><!--perquè no doni error en casos com 'un Cases' -->
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</or>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="a"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="some"/>
		    </get-case-from>
		  </let>
		  <let>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.qnt"/>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="another"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="other"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="little"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="few"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="how much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="how many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="less"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="fewer"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="so much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="so many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="too much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too many"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>

	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="menos"/>
		</equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="less"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="fewer"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>
	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="demasiado"/>
		</equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too many"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>
	  </choose>
	</when>

      </choose>
    </def-macro>

 <def-macro n="f_concord2" npar="2"><!--element 1= principal (nom). Element 2 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>	

	  </choose>
	</when>
      </choose>
</def-macro>
		
	


<def-macro n="f_concord3" npar="3"><!--element 1= principal (nom). Element 2 i 3 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="3" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
</def-macro>


<def-macro n="f_concord4" npar="4"><!--element 1= principal (nom). Element 2 i 3 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="3" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="4" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="4" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="4" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="4" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
</def-macro>
		  



<def-macro n="elimina_ND" npar="1">
  <choose>
    <when>
      <test>
	<equal>
	  <clip pos="1" side="tl" part="nbr"/>
	  <lit-tag v="ND"/>
	</equal>
      </test>
      <let>
	<clip pos="1" side="tl" part="nbr"/>
	<lit-tag v="sg"/>
      </let>
    </when>
  </choose>
</def-macro>
	
	  


  <def-macro n="firstWord" npar="1"><!--nova versió 8-febr-08  -->
      
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <choose>
		<when>
		  <test>
		    <and>
		       <equal>
			<clip pos="1" side="sl" part="a_np_acr"/>
			<lit v=""/>
		      </equal>
		      <not>
			<in>
			  <clip pos="1" side="tl" part="lem"/>
			  <list n="en_majuscules"/>
			</in>
		      </not> 	      
		    </and>
		  </test>
		  <modify-case>
		    <clip pos="1" side="tl" part="lem"/>
		    <lit v="aa"/>
		  </modify-case>
		</when>
	      </choose>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	    <otherwise> 
	      <let>
		<var n="caseFirstWord"/>
		<lit v="aa"/>
	      </let>
	    </otherwise>
	  </choose>
<!--	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>-->
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>


<def-macro n="prep_inf" npar="2">
      <choose>
	<when>
	  <test>
	    <or>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="para"/>
	      </equal>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="de"/>
	      </equal>	      
	    </or>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <get-case-from pos="1">
	      <lit v="to"/>
	    </get-case-from>
	  </let>
	</when>
	<when>
	  <test>
	    <equal caseless="yes">	      
	      <clip pos="1" side="sl" part="lem"/>
	      <lit v="por"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <get-case-from pos="1">
	      <lit v="for"/>
	    </get-case-from>
	  </let>
	</when>
      </choose>
      <choose>	    
	<when>
	  <test>
	    <equal caseless="yes">
	      <clip pos="2" side="sl" part="lem"/> 
	      <lit v="poder"/>
	    </equal>
	  </test>
	  <let>		     
	    <clip pos="2" side="tl" part="lem"/>
	    <get-case-from pos="2">
	      <lit v="be able to"/>
	    </get-case-from>
	  </let>
	  <let>		     
	    <clip pos="2" side="tl" part="a_verb"/>
	    <lit-tag v="vbmod"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <not>
	      <in caseless="yes">
		<clip pos="1" side="tl" part="lem"/>
		<list n="preps_inf"/>
	      </in>
	    </not>
	  </test>
	  <let>	    
	    <clip pos="2" side="tl" part="temps"/>
	    <lit-tag v="ger"/>
	  </let>
	  <let>
	    <var n="tempsv"/>
	    <lit v="ger"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="tempsv"/>
	    <lit v="inf"/>
	  </let>
	</otherwise>
      </choose>
</def-macro>


<def-macro n="adv_adj" npar="2"><!-- (per a fer el comparatiu si cal: 'més fosc' = darker; i també per a canviar 'well' per 'very' davant adjectius )". En les regles, és obligatori que s'executi després de la macro 'f_superlatiu1' aplicada a l'adjectiu.  -->
	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="más"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="mucho más"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
		<lit v="much"/>
	      </get-case-from>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="1" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="bien"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="a_adj"/>
		    <lit-tag v="vblex.pp"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <get-case-from pos="1">
		    <lit v="very"/>
		  </get-case-from>
		  <lit-tag v="preadv"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="1" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</concat>
	    </let>
	  </otherwise>
	</choose>

	      
		
		
</def-macro>

<def-macro n="det_adv_adj" npar="3"><!-- (per a fer el comparatiu i superlatiu si cal: 'més fosc' = 'darker'; 'el més fosc' = 'the darkest')". En les regles, és obligatori que s'executi després de la macro 'f_superlatiu1' aplicada a l'adjectiu. -->
	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="más"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="a_det"/>
		    <lit-tag v="det.def"/>
		  </equal>
		</test>		  
		<let>
		  <var n="adv_adjectiu"/>
		  <concat>
		    <clip pos="3" side="tl" part="lem"/> 
		    <clip pos="3" side="tl" part="a_adj"/>
		    <lit-tag v="sup"/>
		  </concat>
		</let>
	      </when>
	      <otherwise>	  
		<let>
		  <var n="adv_adjectiu"/>
		  <concat>
		    <clip pos="3" side="tl" part="lem"/> 
		    <clip pos="3" side="tl" part="a_adj"/>
		    <lit-tag v="comp"/>
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </when>

	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="mucho más"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>	      
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="much"/>
	      </get-case-from>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="más"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="a_det"/>
		  <lit-tag v="det.def"/>
		</equal>
	      </and>
	    </test>	
	    <let>  
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="most"/>
	      </get-case-from>
	    </let>		    
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="bien"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="a_adj"/>
		    <lit-tag v="vblex.pp"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <get-case-from pos="2">
		    <lit v="very"/>
		  </get-case-from>
		  <lit-tag v="preadv"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</concat>
	    </let>
	  </otherwise>
	</choose>
</def-macro>


<def-macro n="el_millor_pitjor" npar="2"><!-- per a crear forma superlativa quan lema és superlatiu i l'article és definit o poss -->
       <choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.def"/>		
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.pos"/>		
		  </equal>
		</or>
		<or>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="mejor"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="peor"/>
		  </equal>
		</or>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <lit-tag v="adj.sint.sup"/>
	    </let>
	  </when>
	</choose> 
</def-macro>     
		

		

 <def-macro n="f_superlatiu1" npar="1">
   <choose>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="grau"/>
	   <lit-tag v="sup"/>
	 </equal>
       </test>
       <let>
	 <var n="superlatiu1"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="very"/>
	   </get-case-from>
	   <lit-tag v="preadv"/>
	   <lit v="$ ^"/>
	 </concat>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lem"/>
	 <lit v="aa"/>
       </modify-case>
       <choose>
	 <when>
	   <test>
	     <equal>
	       <clip pos="1" side="tl" part="a_adj"/>
	       <lit-tag v="adj.sint.sup"/>
	     </equal>
	   </test>
	   <let>
	     <clip pos="1" side="tl" part="a_adj"/>
	     <lit-tag v="adj.sint"/>
	   </let>
	 </when>
       </choose>
     </when>
     <otherwise>
       <let>
	 <var n="superlatiu1"/>
	 <lit v=""/>
       </let>
     </otherwise>
   </choose>
 </def-macro>
	 


 <def-macro n="f_superlatiu2" npar="1"><!-- Aquesta és per quan hi ha dos adjs en una regla -->
   <choose>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="grau"/>
	   <lit-tag v="sup"/>
	 </equal>
       </test>
       <let>
	 <var n="superlatiu2"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="very"/>
	   </get-case-from>
	   <lit-tag v="preadv"/>
	   <lit v="$ ^"/>
	 </concat>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lem"/>
	 <lit v="aa"/>
       </modify-case>
       <choose>
	 <when>
	   <test>
	     <equal>
	       <clip pos="1" side="tl" part="a_adj"/>
	       <lit-tag v="adj.sint.sup"/>
	     </equal>
	   </test>
	   <let>
	     <clip pos="1" side="tl" part="a_adj"/>
	     <lit-tag v="adj.sint"/>
	   </let>
	 </when>
       </choose>
     </when>
     <otherwise>
       <let>
	 <var n="superlatiu2"/>
	 <lit v=""/>
       </let>
     </otherwise>
   </choose>
 </def-macro>
	


 <def-macro n="conj_verb2" npar="2"><!--conjuga un verb + inf -->

	<choose>
	  <when>
	    <test><!--Si és verb 'ser' p1 o p3 en present o passat (o subjuntiu) té una conjugació pròpia en anglès. Inclou 'ser' i 'estar', tots dos són 'vbser' en anglès (to be) -->
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="ifi"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fts"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		</or>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="2" side="tl" part="lemh"/>
		<clip pos="2" side="tl" part="a_verb"/>
		<clip pos="2" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="2" side="tl" part="lemh"/>
		<clip pos="2" side="tl" part="a_verb"/>
		<clip pos="2" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </concat>
	    </let>
	  </when>


	  <when> 
	    <test><!--La resta de verbs tenen també prs i nbr per a p3 sg, excepte auxiliars (can). -->
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
		<not>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</not>
	      </and>
	    </test>

	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="2" side="tl" part="lemh"/>
		<clip pos="2" side="tl" part="a_verb"/>
		<clip pos="2" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </concat>
	    </let>

	  </when>
	  <otherwise><!--la resta de formes verbals no tenen pers i nbr en anglès -->
	    <choose>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <not>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<modify-case>
		  <clip pos="2" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		  <!--  <get-case-from pos="1">-->
		      <lit v="would"/>
		<!--    </get-case-from>-->
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>


	      </when>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="2" side="sl" part="lem"/> 
		      <lit v="poder"/>
		    </equal>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>

	      <when>
		<test>		 
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </test>
		    <let>		     
		      <clip pos="2" side="tl" part="lem"/>
		      <get-case-from pos="1">
			<lit v="be able to"/>
		      </get-case-from>
		    </let>
		    <let>		     
		      <clip pos="2" side="tl" part="a_verb"/>
		      <lit-tag v="vbmod"/>
		    </let>
		  </when>
		</choose>
		<modify-case>
		  <clip pos="2" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<let>
		  <var n="verbfinal"/>
		  <concat>

		  <!--  <get-case-from pos="1"> -->

		      <lit v="will"/>
		 <!--   </get-case-from> -->
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>

	      </when>

	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/> 
		      <lit-tag v="pri"/><!--dic -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="prs"/><!--digui -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="imp"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="pres"/>
		</let>

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>

		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="ifi"/><!--digué -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pii"/><!--deia -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pis"/><!--digués -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="fts"/><!--dijere -->
		    </equal>
		  </or>
		</test>		   
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	       <otherwise><!--les formes no personals (inf i ger) -->

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
</def-macro>



 <def-macro n="conj_verb1" npar="1"><!--conjuga un verb -->

	<choose>
	  <when>
	    <test><!--Si és verb 'ser' p1 o p3 en present o passat (o subjuntiu) té una conjugació pròpia en anglès. Inclou 'ser' i 'estar', tots dos són 'vbser' en anglès (to be) -->
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="ifi"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fts"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		</or>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </concat>
	    </let>
	  </when>


	  <when> 
	    <test><!--La resta de verbs tenen també prs i nbr per a p3 sg, excepte auxiliars (can). -->
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
		<not>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</not>
	      </and>
	    </test>

	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </concat>
	    </let>

	  </when>
	  <otherwise><!--la resta de formes verbals no tenen pers i nbr en anglès -->
	    <choose>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <not>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<modify-case>
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		  <!--  <get-case-from pos="1">-->
		      <lit v="would"/>
		<!--    </get-case-from>-->
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>


	      </when>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/> 
		      <lit v="poder"/>
		    </equal>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>

	      <when>
		<test>		 
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </test>
		    <let>		     
		      <clip pos="1" side="tl" part="lem"/>
		      <get-case-from pos="1">
			<lit v="be able to"/>
		      </get-case-from>
		    </let>
		    <let>		     
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vbmod"/>
		    </let>
		  </when>
		</choose>
		<modify-case>
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<let>
		  <var n="verbfinal"/>
		  <concat>

		  <!--  <get-case-from pos="1"> -->

		      <lit v="will"/>
		 <!--   </get-case-from> -->
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>

	      </when>

	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/> 
		      <lit-tag v="pri"/><!--dic -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="prs"/><!--digui -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="imp"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="pres"/>
		</let>

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>

		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="ifi"/><!--digué -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pii"/><!--deia -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pis"/><!--digués -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="fts"/><!--dijere -->
		    </equal>
		  </or>
		</test>		   
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	       <otherwise><!--les formes no personals (inf i ger) -->

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
</def-macro>


 <def-macro n="conj_haverhi_pp" npar="1"><!--conjuga el verb haver-hi quan va seguit de pp -->
    <let>
      <var n="pers_chunk"/>
      <clip pos="1" side="sl" part="pers"/>
    </let>
   <choose>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pri"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="prs"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="imp"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <clip pos="1" side="tl" part="temps"/>
	 <lit-tag v="pri"/>
       </let>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/> 
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="ifi"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pii"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pis"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="fts"/>
	   </equal>
	 </or>
       </test>		   
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="past"/>
       </let>	

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="cni"/>
	 </equal>


       </test>

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi_pp"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	  <!-- <get-case-from pos="1">-->
	   <lit v="would"/>
	 <!--  </get-case-from>-->
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="fti"/>
	 </equal>
       </test>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi_pp"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	  <!-- <get-case-from pos="1">-->
	     <lit v="will"/>
	  <!-- </get-case-from>-->
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
   </choose>
 </def-macro>


 <def-macro n="conj_haverhi" npar="1"><!--conjuga el verb haver-hi -->
    <let>
      <var n="pers_chunk"/>
      <clip pos="1" side="sl" part="pers"/>
    </let>
   <choose>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pri"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="prs"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="imp"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <clip pos="1" side="tl" part="temps"/>
	 <lit-tag v="pri"/>
       </let>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="ifi"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pii"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pis"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="fts"/>
	   </equal>
	 </or>
       </test>		   
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="past"/>
       </let>	

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="cni"/>
	 </equal>


       </test>

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	  <!-- <get-case-from pos="1">-->
	   <lit v="would"/>
	 <!--  </get-case-from>-->
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="fti"/>
	 </equal>
       </test>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <!--<get-case-from pos="1">-->
	   <lit v="will"/>
	  <!-- </get-case-from>-->
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
   </choose>
 </def-macro>



  </section-def-macros> 

  <section-rules>




    <!--*************************************** REGLES DE SN ******************************************** -->

    <rule comment="REGLA: NOM (per a col·locar la cua en les multiparaules amb g">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag><!--es manté per finalitats informatives -->
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule comment="REGLA: PREP DET TIME">
      <pattern>
	<pattern-item n="a"/>
	<pattern-item n="las"/>
	<pattern-item n="horas"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr_num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv"/></tag>
	    </tags>
	    <lu>   
	      <lit v="at"/>
	      <lit-tag v="pr"/>
	    </lu>
	     <b pos="1"/>
	   <lu>   
	     <clip pos="3" side="tl" part="whole"/>
	    </lu>  
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>  
      </action>
    </rule>

<rule comment="REGLA: ANTROPÒNIM">
      <pattern>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


<rule comment="REGLA: DET ANTROPÒNIM (La Maria - Maria)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

<rule comment="REGLA: TITULO ANTROPÒNIM (Su Majestad Juan Carlos - His Majesty Juan Carlos)">
      <pattern>
	<pattern-item n="majestad"/>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="gen"/>
                <lit-tag v="f"/>
              </equal>	
	    </test>	
            <choose>
	      <when>
    	        <test>
                  <equal>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v="Su Majestad"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="lem"/>
                  <lit v="Her Majesty"/>
                </let>
              </when>
	      <when>
    	        <test>
                  <equal>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v="Su Alteza"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="lem"/>
                  <lit v="Her Highness"/>
                </let>
              </when>
	      <when>
    	        <test>
                  <equal>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v="Su Alteza Real"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="lem"/>
                  <lit v="Her Royal Highness"/>
                </let>
              </when>
            </choose>
          </when>
        </choose>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="REGLA: DET NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	 
      </action>
    </rule>


    <rule comment="REGLA: NUM NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
      <choose>   
          <when>     
            <test>   
              <equal>
                <clip pos="2" side="sl" part="lem"/>
                <lit v="año"/>
              </equal>
            </test>          
           <let>             
             <var n="lema"/>
             <lit v="num_year"/>
           </let>
          </when>
          <otherwise>        
           <let>             
             <var n="lema"/>
             <lit v="num_nom"/>
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: HACE NUM NOM">
      <pattern>
	<pattern-item n="hace"/>
	<pattern-item n="num"/>
	<pattern-item n="periodo"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	</call-macro>
	<out>  
	  <chunk name="hace_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	   <lu>   
	      <lit v="ago"/> 
	      <lit-tag v="adv"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu2">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="superlatiu2"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>
    


    <rule comment="REGLA: DET NOM ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<out>  
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>

  <!-- <rule comment="REGLA: DET DET NOM ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="det_det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>

   <rule comment="REGLA: DET DET NOM (los muchos casos)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="pl"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="lem"/>
		  <lit v="a lot of"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="many"/>
	    </let>
	  </when>
	</choose>	      
	<out>  
	  <chunk name="det_det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule> -->

    <rule comment="REGLA: DET ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


<!-- <rule comment="REGLA: DET DET ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="4"/>
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det_det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="4" side="sl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="nbr" link-to="3"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule> -->


 <rule comment="REGLA: DET ADJ NOM ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>		
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>		
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <var n="superlatiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


 <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<out>  
	  <chunk name="num_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


    <rule comment="REGLA: DET NOM ADV ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1"><!--aquí no envio variable 'superlatiu' perquè s'envia dins de adv_adjectiu -->
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="det_adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="det_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
            <lu>
	      <var n="adv_adjectiu"/>
	    </lu>
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out> 
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>    
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM ADV ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu1"><!--aquí no envio variable 'superlatiu' perquè s'envia dins de adv_adjectiu -->
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="adv_adj">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="num_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
            <lu>
	      <var n="adv_adjectiu"/>
	    </lu>
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>   
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro> 
      </action>
    </rule>



    <rule comment="REGLA: NOM ADJ conj ADJ NOM (aspecte fràgil i tímida aparença -> fragile look and shy appearance. Regla creada perquè no entrin frases que no toquen en la regla següent">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test>	
	    <call-macro n="f_concord2">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>	
	    <call-macro n="f_concord2">
	      <with-param pos="5"/>
	      <with-param pos="4"/>
	    </call-macro>
	    <call-macro n="elimina_ND">
	      <with-param pos="5"/>
	    </call-macro>

	    <out>
	      <chunk name="nom_adj_coo_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/> 
		  <clip pos="5" side="tl" part="a_nom"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <clip pos="5" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>	
	    <call-macro n="f_concord3">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	      <with-param pos="4"/>
	    </call-macro>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	      
	      <b pos="4"/>
	    </out>
	    <out>
	      <chunk name="nom">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/> 
		  <clip pos="5" side="tl" part="a_nom"/>
		  <clip pos="5" side="tl" part="nbr" link-to="3"/>
		  <clip pos="5" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose> 
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ conj ADJ (aspecte fràgil i tímid -> fragile and shy look">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action><!--Pot haver-hi errors per lo de mf perquè pot ser que un sigui m i l'altra f perquè el tagger s'hagi equivocat (noia bonica i interessant). No donarà error en frases com "aspecte fràgil i tímida aparença" perquè entraran per la regla anterior. mireia adequar a novetat mf -->
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <clip pos="4" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <clip pos="4" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test> -->
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	<!--  </when>
	  <otherwise>
	    <out>
	      <chunk name="nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="2"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="4" side="sl" part="gen"/></tag>
		  <tag><clip pos="4" side="sl" part="nbr"/></tag>
		</tags>		 
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu>
	      </chunk>
	    </out>	 
	  </otherwise>
	</choose>      --> 
      </action>
    </rule>


    <rule comment="REGLA: DET NOM ADJ conj ADJ NOM (un aspecte fràgil i tímida aparença -> a fragile look and shy appearance. Regla creada perquè no entrin frases que no toquen en la regla següent)"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="5"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="5" side="sl" part="gen"/>
		  <clip pos="6" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="5" side="sl" part="nbr"/>
		  <clip pos="6" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test>
	    <call-macro n="f_concord3">
	      <with-param pos="2"/>
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	    </call-macro>	
	    <call-macro n="f_concord2">
	      <with-param pos="6"/>
	      <with-param pos="5"/>
	    </call-macro>
	    <call-macro n="elimina_ND">
	      <with-param pos="6"/>
	    </call-macro>
	    <out>
	      <chunk name="det_nom_adj_coo_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>

		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="5"/>
		<lu>
		  <clip pos="6" side="tl" part="lemh"/> 
		  <clip pos="6" side="tl" part="a_nom"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <clip pos="6" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <call-macro n="f_concord4">
	      <with-param pos="2"/>
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	      <with-param pos="5"/>
	    </call-macro>
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	      <b pos="5"/>
	    </out>
	    <out>
	      <chunk name="nom">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="6" side="sl" part="gen"/></tag>
		  <tag><clip pos="6" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="6" side="tl" part="lemh"/> 
		  <clip pos="6" side="tl" part="a_nom"/>
		  <clip pos="6" side="tl" part="nbr" link-to="3"/>
		  <clip pos="6" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ conj ADJ (un aspecte fràgil i tímid -> a fragile and shy look">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>		
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="5"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>		
	    </test> -->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
<!--	  </when>
	  <otherwise>	      
	    <out>
	      <chunk name="det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="3"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     --> 
      </action>
    </rule>


    <rule comment="REGLA: DET NOM ADV ADJ conj ADJ (un aspecte muy fràgil i tímid -> a very fragile and shy look">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>		
	<call-macro n="f_superlatiu1">
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	  <with-param pos="6"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>		
	    </test> -->
	    <out> 
	      <chunk name="det_nom_adv_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu> 
                <b pos="2"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4	" side="tl" part="a_adj"/>
		</lu>
                <b pos="3"/>
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="6" side="tl" part="lem"/> 
		  <clip pos="6" side="tl" part="a_adj"/>
		</lu> 
		<b pos="5"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
<!--	  </when>
	  <otherwise>	      
	    <out>
	      <chunk name="det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="3"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     --> 
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ conj ADV ADJ (un aspecte fràgil i molt tímid -> a fragile and very shy look">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>		
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="6"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>		
	    </test> -->
	    <out> 
	      <chunk name="det_nom_adj_coo_adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu>
                <b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
                <b pos="3"/>
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="6" side="tl" part="lem"/> 
		  <clip pos="6" side="tl" part="a_adj"/>
		</lu> 
		<b pos="5"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
<!--	  </when>
	  <otherwise>	      
	    <out>
	      <chunk name="det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="3"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     --> 
      </action>
    </rule>


    <rule comment="REGLA: ADJECTIU (quan no acompanya res o va amb desconeguda)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action> 
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule> 


    <rule comment="REGLA: ADV ADJECTIU (per a fer comparatius i superlatius: 'més llarg - longer')">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	  	
	<call-macro n="f_superlatiu1"><!--'siempre buenísimo' --><!--aquí no envio variable 'superlatiu' perquè s'envia dins de adv_adjectiu -->
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	    <out>
	      <chunk name="adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <var n="adv_adjectiu"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
      </action>
    </rule> 


 <rule comment="REGLA: DET ADJECTIU (el lleig / el millor) ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="2" side="sl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>		
	<out>
	  <chunk name="det_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
      </action>
    </rule> 




   <rule comment="REGLA: DET ADV ADJECTIU (per a fer comparatius i superlatius: 'la més gran - the biggest; la més important - the most important')">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="más"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when><!--trampeta per quan el 'més' no és adv sinó determinant, per a arreglar-ho. -->
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="a_adv"/> 
		<lit v=""/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="2" side="tl" part="whole"/> 
	      <concat>
		<clip pos="2" side="tl" part="lem"/> 
		<lit-tag v="adv"/>
	      </concat>
	    </let>
	  </when>
	</choose>	
	<call-macro n="det_adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	 

	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="sl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="3" side="sl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>
	      
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="más"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test> -->
	    <out>
	      <chunk name="det_adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <var n="adv_adjectiu"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
      </action>
    </rule> 


    <rule comment="REGLA: DETERMINANT (perquè no doni error si va davant de desconegudes i no es pot assignar nombre. MG: falta regla t2x per al ND)">
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>        	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>



<rule comment="REGLA: el (num)%">
      <pattern>
	<pattern-item n="el_un"/>
	<pattern-item n="percent"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="percent">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/>   
	    </lu>
	  </chunk>
	</out> 
      </action>
</rule>


    <!-- *************************************** REGLES DE SV *********************************************** -->

 <rule comment="REGLA: HABER">
      <pattern>
	<pattern-item n="hay"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	     
		<lit v="be"/>	      
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="1"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		 <!-- <get-case-from pos="1">-->
		    <lit v="there"/> 
		 <!-- </get-case-from>-->
		  <lit-tag v="adv"/>
		</lu>
		<b/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	    </out>
      </action>
    </rule>




    <rule comment="REGLA: HABER QUE">
      <pattern>
	<pattern-item n="haber_que"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	
	  <!-- envia el pronom subjecte 'it' -->
	    <out>
	      <chunk name="prpers" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><lit-tag  v="subj"/></tag>
		  <tag><lit-tag  v="p3"/></tag>
		  <tag><lit-tag  v="nt"/></tag>
		  <tag><lit-tag  v="sg"/></tag>
		</tags>
		<lu>   
		  <get-case-from pos="1">
		    <lit v="prpers"/> 
		  </get-case-from>
		  <lit-tag v="prn"/>  
		  <lit-tag v="2"/> 
		  <lit-tag v="p3"/>
		  <lit-tag v="nt"/>
		  <lit-tag v="sg"/>
		</lu> 
	      </chunk>
	      <b/>
	    </out> 
	    <let>
		<var n="caseFirstWord"/>
		<lit v="aa"/>
	    </let> 	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

  

    <rule comment="REGLA: VERB conjugat">
      <pattern>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
              <when>
                <test>
                    <equal caseless="yes">
                      <clip pos="1" side="sl" part="lem"/>
                      <lit v="tener"/>
                    </equal>
                </test>
                <let>  
                  <var n="lema_SV"/>
                  <lit v="tohavevblex"/>
                </let>
              </when> 
              <otherwise>
                <let>
                  <var n="lema_SV"/>
                  <var n="lema_SV"/>
                </let>
               </otherwise>
             </choose>  
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

  
    <rule comment="LLEGAR + a + INF (llegó a decir)">
      <pattern>
        <pattern-item n="llegar"/>
        <pattern-item n="a"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="conj_verb2">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="3" side="sl" part="lem"/><list n="llegar_even"/></in>
            </test>
            <let><var n="modAdv"/><concat><lit v="^even"/><lit-tag v="adv"/><lit v="$ "/></concat></let>
            <let><var n="lema_SV"/><concat><lit v="adv_"/><var n="lema_SV"/></concat></let>
          </when>
          <otherwise>
            <let><var n="modAdv"/><lit v=""/></let>
          </otherwise>
        </choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
                <var n="modAdv"/>
		<lu>
                  <var n="verbfinal"/>
		</lu>
	      </chunk>
        </out>
      </action>
    </rule>

    <rule comment="HAVER + LLEGADO + A + INF (ha arribat a dir - has even said)">
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="llegado"/> 
	<pattern-item n="a"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>

	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver"/>
	    </let>
	  </otherwise>
	</choose>	
        <choose>
          <when>
            <test>
              <in caseless="yes"><clip pos="4" side="sl" part="lem"/><list n="llegar_even"/></in>
            </test>
            <let><var n="modAdv"/><concat><lit v="^even"/><lit-tag v="adv"/><lit v="$ "/></concat></let>
            <let><var n="lema_SV"/><concat><var n="lema_SV"/><lit v="_adv_pp"/></concat></let>
          </when>
          <otherwise>
            <let><var n="modAdv"/><lit v=""/></let>
            <let><var n="lema_SV"/><concat><var n="lema_SV"/><lit v="_pp"/></concat></let>
          </otherwise>
        </choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>
                <var n="modAdv"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
                  <lit-tag v="pp"/>
		  <clip pos="4" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	    </out>
      </action>
    </rule>


    <rule comment="HAVER + PP (han vist - have seen)">
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<choose>
	  <when><!--Mira si és 'ha habido'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="1"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		  <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'ha habido' -->   
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <clip pos="2" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
      </action>
    </rule>

    <rule comment="lo/la HAVER + pasar bien (lo han pasado bien) - regla lexicalizada antes de la correspondiente regla general 'pro HAVER + PP' ">
      <pattern>
	<pattern-item n="pro_lola"/>
	<pattern-item n="haver"/> 
	<pattern-item n="verb_pronlex_pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    	
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>

	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <clip pos="3" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>	
	<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
      </action>
    </rule>

    <rule comment="pro HAVER + PP (l'han vist - have seen it)">
      <pattern>
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when><!--Mira si és 'ha habido'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_pp"/>
		</lu> 
	      </chunk>
	      <b/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'xx ha habido' -->
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="lem"/> 
		  <get-case-from pos="3">
		    <lit v="be able to"/>
		  </get-case-from>
		</let>
		<let>
		  <clip pos="3" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		    <not>
			<equal>
			  <clip pos="3" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
		    </not>
		  </and>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/> 
			<clip pos="3" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="1" side="tl" part="lem"/>
			<clip pos="1" side="tl" part="a_prn"/>
			<clip pos="1" side="tl" part="tipus_prn"/>
			<clip pos="1" side="tl" part="pers"/>
			<clip pos="1" side="tl" part="gen"/>
			<clip pos="1" side="tl" part="nbr"/>		           
			<clip pos="3" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb, després mirem si cal imprimir el pronom (en verbs pronominals no cal si pronom conocorda amb pers del verb)-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_pp"/>
		      <clip pos="3" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		</out>
		<choose><!-- ... i després enviem el prn (si cal)-->
		  <when>
		    <test>
		      <and>
			<equal>
			  <clip pos="3" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
			<equal>
			  <clip pos="1" side="sl" part="pers"/>
			  <clip pos="2" side="sl" part="pers"/>
			</equal>
			<or>
			  <equal>
			    <clip pos="1" side="sl" part="nbr"/>
			    <clip pos="2" side="sl" part="nbr"/>
			  </equal>
			  <equal caseless="yes">
			    <clip pos="1" side="sl" part="lem"/>
			    <lit v="se"/><!--és 'sp' -->
			  </equal>
			</or>
		      </and>
		    </test>	
		    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		      <with-param pos="2"/>
		      <with-param pos="3"/>
		    </call-macro>
		  </when>
		  <otherwise><!--enviamos el pronombre. si es el pronombre reflexivo, el lema del chunk será 'ref' y el chunk estará vacío (este pronombre no tiene traducción en el diccionario) -->
		    <choose>
		      <when>
			<test>
			  <equal caseless="yes">
			    <clip pos="1" side="sl" part="lem"/>
			    <lit v="se"/>
			  </equal>
			</test>
			<let>
			  <var n="lema"/>
			  <lit v="ref"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="ref"/>
			</let>
		      </when>
		      <otherwise>
			<let>
			  <var n="lema"/>
			  <lit v="pro"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="SN"/>
			</let>
		      </otherwise>
		    </choose>	
		    <out>
		      <b pos="2"/>
		      <chunk namefrom="lema">
			<tags>
			  <tag><var n="nom_chunk"/></tag>
			  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="1" side="sl" part="pers"/></tag>
			  <tag><clip pos="1" side="tl" part="gen"/></tag>
			  <tag><clip pos="1" side="tl" part="nbr"/></tag>
			</tags>
			<lu>
			  <clip pos="1" side="tl" part="whole"/>
			</lu>
		      </chunk>
		    </out>
		  </otherwise>
		</choose>  
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

 <rule comment="pro + lo/la + HAVER + pasar bien (se lo han pasado bien) - regla lexicalizada antes de la correspondiente regla general 'pro + pro + HAVER + PP' ">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro_lola"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="verb_pronlex_pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="3" side="tl" part="pers"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_pp"/>
	      <clip pos="4" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>
	  <call-macro n="f_bcond"> 
	    <with-param pos="3"/>
	    <with-param pos="4"/>
	  </call-macro>	
	</action>
      </rule>

  <rule comment="pro + pro + HAVER + PP (se lo han dado - have given it to him)">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="lem"/> 
		  <get-case-from pos="4">
		    <lit v="be able to"/>
		  </get-case-from>
		</let>
		<let>
		  <clip pos="4" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		    <equal>
		      <clip pos="4" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/> 
			<clip pos="4" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="4" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
		<call-macro n="f_bcond"> 
		  <with-param pos="2"/>
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb i després el pronom-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_pp"/>
		      <clip pos="4" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		  <b pos="2"/>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		    </out>
		  </otherwise>
		</choose> 
		<choose><!--ara ens cuidem del primer pronom -->
		  <when>
		    <test>
		      <not><!--si no es dóna el cas que el verb és pronominal... --> 
			<or>
			  <and>
			    <equal>
			      <clip pos="4" side="sl" part="pron"/>
			      <lit-tag v="pron"/>
			    </equal>
			    <equal>
			      <clip pos="1" side="sl" part="pers"/>
			      <clip pos="3" side="sl" part="pers"/>
			    </equal>
			    <or>
			      <equal>
				<clip pos="1" side="sl" part="nbr"/>
				<clip pos="3" side="sl" part="nbr"/>
			      </equal>
			      <equal caseless="yes">
				<clip pos="1" side="sl" part="lem"/>
				<lit v="se"/><!--és 'sp' -->
			      </equal>
			    </or>
			  </and>  <!--o el primer enclític es tradueix per res ([se]) -->
			  <equal>
			    <clip pos="1" side="tl" part="whole"/>
			    <lit v=""/>
			  </equal>
			</or>
		      </not>
		    </test>
		    <out>
		      <chunk name="to_prn">
			<tags>
			  <tag><lit-tag v="SP"/></tag>
			  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="1" side="tl" part="pers"/></tag>
			  <tag><clip pos="1" side="tl" part="gen"/></tag>
			  <tag><clip pos="1" side="tl" part="nbr"/></tag>
			</tags>	
			<b pos="3"/>
			<lu>
			  <get-case-from pos="2">
			    <lit v="to"/>
			  </get-case-from>
			  <lit-tag v="pr"/>
			</lu>
			<b/>
			<lu>
			  <clip pos="1" side="tl" part="whole"/>
			</lu> 
		      </chunk>
		    </out>
		  </when>
		  <when> <!--si el pronom és 'se' i no era un verb pronominal, envia'l -->
		    <test>
		      <and>
			<not>
			  <equal>
			    <clip pos="4" side="sl" part="pron"/>
				<lit-tag v="pron"/>
			      </equal>
			    </not>
			    <equal caseless="yes">
			      <clip pos="1" side="sl" part="lem"/>
			      <lit v="se"/>
			    </equal>
			  </and>
			</test>
			<out>
			  <b pos="3"/>
			  <chunk name="ref">
			    <tags>
			      <tag><lit-tag v="ref"/></tag>
			      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
			      <tag><clip pos="1" side="sl" part="pers"/></tag>
			      <tag><clip pos="1" side="tl" part="gen"/></tag>
			      <tag><clip pos="1" side="tl" part="nbr"/></tag>
			    </tags>
			    <lu>
			      <clip pos="1" side="tl" part="whole"/>
			    </lu>
			  </chunk>
			</out>
		  </when>
		  <otherwise>
<!--si el verb era pronominal y el pronom era 'se' -->
		    <call-macro n="f_bcond"> 
		      <with-param pos="3"/>
		      <with-param pos="4"/>
		    </call-macro>
		  </otherwise>
		</choose>
	      </action>
	    </rule>
	    
 	 
   
	    <rule comment="REGLA: PROCLÍTIC HAY">
      <pattern>
	<pattern-item n="pro_noref"/>
	<pattern-item n="hay"/>
      </pattern>
      <action> 	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
      <let>
	<clip pos="2" side="tl" part="lem"/>
	<get-case-from pos="2">
	  <lit v="be"/>
	</get-case-from>
      </let>
      <let>
	<clip pos="2" side="tl" part="a_verb"/>
	<lit-tag v="vbser"/>
      </let>
      <call-macro n="conj_haverhi">
	<with-param pos="2"/>
      </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	      <b/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
      </action>
</rule>

  <rule comment="REGLA: PROCLÍTIC pasar bien - regla lexicalizada antes de la correspondiente regla general 'PROCLÍTIC VERB conjugat'">
      <pattern>
	<pattern-item n="pro_lola"/>
	<pattern-item n="verb_pronlex"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	 
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>	
	    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro> 
      </action>
    </rule>

    <rule comment="REGLA: PROCLÍTIC VERB conjugat">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>	 
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_prn"/>
		    <clip pos="1" side="tl" part="tipus_prn"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>
		    <clip pos="1" side="tl" part="nbr"/>		           
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>		  
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="2" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="1"/>
		  <with-param pos="2"/>
		</call-macro>
	      </when>
	      <otherwise> 
		<choose>
		      <when>
			<test>
			  <equal caseless="yes">
			    <clip pos="1" side="sl" part="lem"/>
			    <lit v="se"/>
			  </equal>
			</test>
			<let>
			  <var n="lema"/>
			  <lit v="ref"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="ref"/>
			</let>
		      </when>
		      <otherwise>
			<let>
			  <var n="lema"/>
			  <lit v="pro"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="SN"/>
			</let>
			<choose>
			  <when>
			    <test>
			      <in caseless="yes">
				<clip pos="2" side="sl" part="lem"/>
				<list n="añadir_prep_pron"/>
			      </in>
			    </test>
			    <let>
			      <var n="prepo"/>
			      <concat>
				<get-case-from pos="2">
				  <lit v="for"/>
				</get-case-from>
				<lit-tag v="pr"/>
			      </concat>
			    </let>
			    <out>
			      <b/>
			      <chunk name="pr">
				<tags>
				  <tag><lit-tag v="PREP"/></tag>
				</tags>
				<lu>
				  <var n="prepo"/>
				</lu>
			      </chunk>
			    </out>
			  </when>
			  <otherwise>
			    <let>
			      <var n="prepo"/>
			      <lit v=""/>
			    </let>
			  </otherwise>
			</choose>
		      </otherwise>
		    </choose>	
		<out>
		  <b pos="1"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

 <rule comment="REGLA: PROCL + lo/la + pasar bien - regla lexicalizada antes de la correspondiente regla general 'PROCL + PROCL + VERB conjugat">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro_lola"/>
	<pattern-item n="verb_pronlex"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>	    
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> 
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	      <!--<with-param pos="3"/>--> <!-- f_bcond només funciona amb dos parametres -->
	    </call-macro>
      </action>
    </rule>

  <rule comment="REGLA: PROCL + PROCL + VERB conjugat (se lo digo)">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<choose>	 
	  <when>
	    <!-- si el verb és separable, posa el 2n clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
	    </test>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem el blanc -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->	    
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	      <b pos="1"/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<choose><!--ara mirem el primer pronom -->
	  <when>
	    <test>
	      <not><!--si no es dóna el cas que... --> 
		<or>
		  <and><!--o el verb és pronominal-->
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and><!--o el primer enclític es tradueix per res ([se]) -->
		  <equal>
		    <clip pos="1" side="tl" part="whole"/>
		    <lit v=""/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out><!--imprimeix 'to + prn' -->
	      <chunk name="to_prn">
		<tags>
		  <tag><lit-tag v="SP"/></tag>
		  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>	
		<b pos="2"/>
		<lu>
		  <get-case-from pos="2">
		    <lit v="to"/>
		  </get-case-from>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <choose>
	    <when> <!--si el pronom és 'se' i no era un verb pronominal, envia'l -->
		    <test>
		      <and>
			<not>
			  <equal>
			    <clip pos="3" side="sl" part="pron"/>
				<lit-tag v="pron"/>
			      </equal>
			    </not>
			    <equal caseless="yes">
			      <clip pos="1" side="sl" part="lem"/>
			      <lit v="se"/>
			    </equal>
			  </and>
			</test>
			<out>
			  <b pos="2"/>
			  <chunk name="ref">
			    <tags>
			      <tag><lit-tag v="ref"/></tag>
			      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
			      <tag><clip pos="1" side="sl" part="pers"/></tag>
			      <tag><clip pos="1" side="tl" part="gen"/></tag>
			      <tag><clip pos="1" side="tl" part="nbr"/></tag>
			    </tags>
			    <lu>
			      <clip pos="1" side="tl" part="whole"/>
			    </lu>
			  </chunk>
			</out>
		  </when>
		  <otherwise>
<!--si el verb era pronominal y el pronom era 'se' -->
		    <call-macro n="f_bcond"> 
		      <with-param pos="2"/>
		      <with-param pos="3"/>
		    </call-macro>
		  </otherwise> 
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>



   <rule comment="pasar bien + lo/la (pasarlo bien) - regla lexicalizada antes de la correspondiente regla general 'VERB + ENCL'">
      <pattern>
	<pattern-item n="verb_pronlex_infger"/>
	<pattern-item n="enc_lola"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="1" side="tl" part="temps"/> 
		  <lit-tag v="inf"/>
	      </equal>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="inf"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="ger"/>
	    </let>  
	  </otherwise>	
	</choose>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
	      </chunk>
	    </out>
      </action>
    </rule>

 <rule comment="pasar bien + lo/la (pásalo bien) - regla lexicalizada antes de la correspondiente regla general 'VERB + ENCL'">
      <pattern>
	<pattern-item n="verb_pronlex_imp"/>
	<pattern-item n="enc_lola"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	    <out>
	      <chunk name="imp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
	      </chunk>
	    </out>
      </action>
    </rule>

   <rule comment="VERB + ENCL (ajudar-me - help me)">
      <pattern>
	<pattern-item n="verbnm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <in caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <list n="añadir_prep_pron"/>
		  </in>
		</test>
		<let>
		  <var n="prepo"/>
		     <concat>
		       <lit v="for"/>
		       <lit-tag v="pr"/>
		     </concat>
		</let>
		<let>
		  <var n="espai"/>
		  <lit v=" "/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verb_pr_enc"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="prepo"/>
		  <lit v=""/>
		</let>
		<let>
		  <var n="espai"/>
		  <lit v=""/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verb_enc"/>
		</let>
	      </otherwise>
	    </choose>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/> 	        
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <var n="prepo"/>
		</lu>
		<var n="espai"/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>	
		</lu>
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>

    <rule comment="VERB + ENCL (ajuda'm - help me)">
      <pattern>
	<pattern-item n="verbnm_imp"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>  
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="pron"/>
		  <lit-tag v="pron"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <clip pos="2" side="sl" part="pers"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="se"/><!--és 'sp' -->
		  </equal>
		</or>
	      </and>
	    </test>
	    <let><!--esborra el pronom quan coincideix en pers i nbr amb el verb pronominal -->
	      <clip pos="2" side="tl" part="whole"/>
	      <lit v=""/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="imp_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="imp_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>

   <rule comment="pasar bien + ENCL + lo/la (pasárselo bien) - regla lexicalizada antes de la correspondiente regla general 'VERB + ENCL + ENCL'">
      <pattern>
	<pattern-item n="verb_pronlex_infger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc_lola"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="1" side="tl" part="temps"/> 
		  <lit-tag v="inf"/>
	      </equal>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="inf"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="ger"/>
	    </let>  
	  </otherwise>	 
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="sl" part="temps"/></tag>
	    </tags> 
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>  
	  </chunk>
	</out>
      </action>
   </rule>

  <rule comment="pasar bien + ENCL + lo/la (pásatelo bien) - regla lexicalizada antes de la correspondiente regla general 'VERB + ENCL + ENCL'">
      <pattern>
	<pattern-item n="verb_pronlex_imp"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc_lola"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<out>
	  <chunk name="imp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="sl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps"/>	           
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>  
	  </chunk>
	</out>
      </action>
  </rule>
  

    <rule comment="VERB + ENCL + ENCL (portar-me'ls - bring them to me)">
      <pattern>
	<pattern-item n="verbnm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<choose>
	  <when>
	    <test><!--si el segon enclític es tradueix per res (en/hi/[se]) -->
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="VERB + ENCL + ENCL (porta-me'ls - bring them to me)">
      <pattern>
	<pattern-item n="verbnm_imp"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>  
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="pron"/>
		  <lit-tag v="pron"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <clip pos="2" side="sl" part="pers"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="se"/><!--és 'sp' -->
		  </equal>
		</or>
	      </and>
	    </test>
	    <let><!--esborra el pronom quan coincideix en pers i nbr amb el verb pronominal -->
	      <clip pos="2" side="tl" part="whole"/>
	      <lit v=""/>
	    </let>
	  </when>
	</choose>
	
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps"/> 
		      </lu>  
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



 


    <rule comment="VERBMOD + ENCL + INF (poder-ho fer - be able to do it)(no he fet res per a pronominals, difícil fer la concordança de persona en frases que no són de 3a persona ('es'): per poder-te enamorar...">
      <pattern>
	<pattern-item n="verbm"/> <!-- aquí tb separaria entre inf/ger i imperatiu, per poder fer enllaços coherents en 'temps' i poder deixar temps 'sl' en imperatiu i 'tl' en inf i ger.-->
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>               	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>   
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>      
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
		<b pos="2"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>      
		    <clip pos="3" side="tl" part="a_verb"/>    
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>      
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>      
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>      
		  <clip pos="3" side="tl" part="a_verb"/>    
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>      
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>  
      </action>
    </rule>

    <rule comment="VERBMOD + ENCL + ENCL + INF (poder-los-ho explicar -> be able to explain it to them)">
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>  
		<out>
		  <chunk name="mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>      
			<clip pos="4" side="tl" part="a_verb"/>    
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>     
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>      
		      <clip pos="4" side="tl" part="a_verb"/>    
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps"/>      
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    
		<out>
		  <chunk name="mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>      
			<clip pos="4" side="tl" part="a_verb"/>     
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>     
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>      
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="temps"/>    
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>


  <rule comment="REGLA: procl + verb modal + inf (em pot sorprendre -> can surprise me)">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="verbm"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when><!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el pot treure -> can take it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>   
	    <out>
	      <chunk name="modcj_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>    
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>  
		<b pos="1"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>      
		    <clip pos="3" side="tl" part="a_verb"/>    
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_prn"/>
		    <clip pos="1" side="tl" part="tipus_prn"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>
		    <clip pos="1" side="tl" part="nbr"/>      
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <out>
	      <chunk name="modcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>      
		  <clip pos="3" side="tl" part="a_verb"/>    
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>      
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out> 
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>	
	      <choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>	
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>


    <rule comment="VERBMOD + ENCL (per quan va davant desconegudes, perquè almenys no peti: poder-ho xxx - be able to it xxx)">
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	  
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="mod_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>      
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>	  
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


    <rule comment="VERBMOD + ENCL + ENCL (per quan va davant desconegudes, perquè almenys no peti: poder-los-ho xxx - be able to them it xxx" >
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	  
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="mod_enc_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>    
      </action>
    </rule>




    <rule comment="REGLA: PARTICIPI (perquè no enviï gènere ni nombre quan va sol (per tal que no doni error). Caldrà posar-lo tb en les regles d'adjectiu">
      <pattern>
	<pattern-item n="pp"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="PER + INF (per ajudar - to help (en general; cal estudiar quan hi va gerundi)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>      	
	<call-macro n="prep_inf">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk namefrom="tempsv">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>          
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>   
      </action>
    </rule>




    <rule comment="PREP + HAVER + PP (per haver ajudat)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="haverinf"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="prep_inf">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro> 
	<let>
	  <clip pos="2" side="tl" part="temps"/> 
	  <lit-tag v="ger"/><!--posem ger en tots els casos -->
	</let>	  
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="3" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/> 
	      <get-case-from pos="3">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="por_haver_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>		  
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/> 
		  <clip pos="2" side="tl" part="temps"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_pp"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	    </out>
      </action>
    </rule>


  <rule comment="AL + INF (al llegar - when arriving)">
      <pattern>
	<pattern-item n="a"/>
	<pattern-item n="el"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="3" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<out>
	  <chunk name="cnj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="cnjadv"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="when"/>
	      </get-case-from>
	      <lit-tag v="cnjadv"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="ger">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>          
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>  
      </action>
    </rule>


<!-- <rule comment="REGLA: PARTICIPI + per (canvia 'for' per 'by' ja que es considera que generalment serà passiva.">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="por"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/> 
	  <lit v="by"/>
	</let>	  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="pr">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out> 
      </action>
    </rule> -->




    <rule comment="PP + PER + INF (preparat per ajudar - prepared to help (perquè no entri per la regla anterior i digui 'prepared by')">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="prep"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>      	
	<call-macro n="prep_inf"><!---MG: en aquest cas, el 'de' potser hauria de traduir-se per 'of'? -->
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp_pr_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  <b pos="2"/>
	    <lu>          
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="REGLA: VERB no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<out>
	  <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: VERB no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>




  <rule comment="REGLA: ESTAR + GER (estan estudiant)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lemh"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	    </lu>
	    <b pos="1"/>	    
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



 <rule comment="REGLA: lo/la ESTAR pasar bien (lo están pasando bien) - regla lexicalizada antes de la correspondiente regla general 'PROCLÍTIC ESTAR GER'">
      <pattern>
	<pattern-item n="pro_lola"/>
	<pattern-item n="estar"/>
	<pattern-item n="verb_pronlex_ger"/>
      </pattern>
      <action>
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="1"/>	    
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
      </action>
 </rule>



 <rule comment="REGLA: PROCL + lo/la + ESTAR + pasar bien (se lo están pasando bien) ">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro_lola"/>
	<pattern-item n="estar"/>
	<pattern-item n="verb_pronlex_ger"/>
      </pattern>
      <action>
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="1"/>	    
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
		  <clip pos="4" side="tl" part="sep"/>
		  <clip pos="4" side="tl" part="temps"/>
		  <clip pos="4" side="tl" part="lemq"/>    
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	      <!--<with-param pos="4"/>--> <!-- FMT: només té 2 parametres -->
	    </call-macro>
      </action>
 </rule>



 <rule comment="REGLA: PROCLÍTIC ESTAR GER (els estan buscant) mireia falta els negatius i amb dos proclítics">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	<choose>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (els estan traient -> are taking them out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="2" side="tl" part="a_verb"/></tag>
		<tag><var n="temps_chunk"/></tag>
		<tag><clip pos="2" side="tl" part="pers"/></tag>
		<tag><clip pos="2" side="tl" part="nbr"/></tag>
	      </tags>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <b pos="1"/>
		  <mlu>	    
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="sep"/>
		      <clip pos="3" side="tl" part="temps"/>   
		    </lu>  
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>		           
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="1"/>	    
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu>
	      </chunk>
	    </out>		  
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
	      <choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>	
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
 </rule>



    <!--**************************** SV precedits d'adverbi (negacions i altres) -->

 <rule comment="REGLA: ADV HAY (no había)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="hay"/>
      </pattern>
      <action> 	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>	      
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <choose>
	      <when>
		<test> 
		  <in caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <list n="adv_intercalados"/>
		  </in>
		</test>
		<let>
		  <var n="lema"/>
		  <lit v="adv-interc"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="lema"/>
		  <lit v="adv"/>
		</let>
	      </otherwise>
	    </choose>		    
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <get-case-from pos="2">
	    <lit v="be"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="2" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<call-macro n="conj_haverhi">
	      <with-param pos="2"/>
	</call-macro> 
	<out>
	      <chunk namefrom="lema_SV"  case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="2">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	    </out>
      </action>
 </rule>



    <rule comment="REGLA: ADV VERB conjugat (no volia)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>	      
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <choose>
	      <when>
		<test> 
		  <in caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <list n="adv_intercalados"/>
		  </in>
		</test>
		<let>
		  <var n="lema"/>
		  <lit v="adv-interc"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="lema"/>
		  <lit v="adv"/>
		</let>
	      </otherwise>
	    </choose>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>	
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="ADV HAVER + PP (no han vist - have  seen)">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <choose>
	      <when>
		<test> <!--para hacerlo mejor, habría que poner el adverbio entre 'have' y 'pp' -->
		  <in caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <list n="adv_intercalados"/>
		  </in>
		</test>
		<let>
		  <var n="lema"/>
		  <lit v="adv-interc"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="lema"/>
		  <lit v="adv"/>
		</let>
	      </otherwise>
	    </choose>	
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
	<choose>
	  <when><!--Mira si és 'ha habido'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV"  case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="2">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'ha habido' -->   
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="3" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/> 
	      <get-case-from pos="3">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>

	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <clip pos="3" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>
	  </otherwise>
	</choose>
      </action>
    </rule>


    <rule comment="ADV pro (lo/la) HAVER + PP(pasar bien) (no lo han pasado bien) - regla lexicalizada antes de la correspondiente regla general">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="pro_lola"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="verb_pronlex_pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose> 
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="3" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="3" side="tl" part="pers"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_pp"/>
	      <clip pos="4" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
      </action>
    </rule>

 <rule comment="ADV + pro + pro (lo/la) HAVER + PP(pasar bien) (no se lo han pasado bien)- regla lexicalizada antes de la correspondiente regla general">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="pro"/> 
	<pattern-item n="pro_lola"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="verb_pronlex_pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <!--<call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>--> <!-- f_bcond requereix 2 parametres -->
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose> 
	<call-macro n="conj_verb1">
	  <with-param pos="4"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="4" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="5" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="4" side="tl" part="pers"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_pp"/>
	      <clip pos="5" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	  <!--<with-param pos="5"/>--> <!-- FMT: només té dos parametres -->
	</call-macro>
      </action>
    </rule>


    <rule comment="ADV pro HAVER + PP (no els han vist - have not seen them)">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose> 
	<choose>
	  <when><!--Mira si és '(lo) ha habido' -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="4" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <get-case-from pos="4">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="3"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="2">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'ha habido' -->
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="lem"/> 
		  <get-case-from pos="4">
		    <lit v="be able to"/>
		  </get-case-from>
		</let>
		<let>
		  <clip pos="4" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>

	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		  <and>
		    <equal>
		      <clip pos="4" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		    <not>
		      <equal>
			<clip pos="4" side="sl" part="pron"/>
			<lit-tag v="pron"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/> 
			<clip pos="4" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="4" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb, després mirem si cal imprimir el pronom (en verbs pronominals no cal si pronom conocorda amb pers del verb)-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_pp"/>
		      <clip pos="4" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		</out>
		<!-- ... i després enviem el prn (si cal)-->
		<choose>
		  <when>
		    <test>
		      <and>
			<equal>
			  <clip pos="4" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="pers"/>
			  <clip pos="3" side="sl" part="pers"/>
			</equal>
			<or>
			  <equal>
			    <clip pos="2" side="sl" part="nbr"/>
			    <clip pos="3" side="sl" part="nbr"/>
			  </equal>
			  <equal caseless="yes">
			    <clip pos="2" side="sl" part="lem"/>
			    <lit v="se"/><!--és 'sp' -->
			  </equal>
			</or>
		      </and>
		    </test>	
		    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		      <with-param pos="3"/>
	              <with-param pos="4"/>
		    </call-macro>
		  </when>
		  <otherwise><!--enviamos el pronombre. si es el pronombre reflexivo, el lema del chunk será 'ref' y el chunk estará vacío (este pronombre no tiene traducción en el diccionario) -->
		    <choose>
		      <when>
			<test>
			  <equal caseless="yes">
			    <clip pos="2" side="sl" part="lem"/>
			    <lit v="se"/>
			  </equal>
			</test>
			<let>
			  <var n="lema"/>
			  <lit v="ref"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="ref"/>
			</let>
		      </when>
		      <otherwise>
			<let>
			  <var n="lema"/>
			  <lit v="pro"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="SN"/>
			</let>
		      </otherwise>
		    </choose>	
		    <out>
		      <b pos="3"/>
		      <chunk namefrom="lema">
			<tags>
			  <tag><var n="nom_chunk"/></tag>
			  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="2" side="sl" part="pers"/></tag>
			  <tag><clip pos="2" side="tl" part="gen"/></tag>
			  <tag><clip pos="2" side="tl" part="nbr"/></tag>
			</tags>
			<lu>
			  <clip pos="2" side="tl" part="whole"/>
			</lu>
		      </chunk>
		    </out>
		  </otherwise>
		</choose>  
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

    <rule comment="PER + NO + INF (per no oblidar - not to forget">
      <pattern>
	<pattern-item n="para"/> 
	<pattern-item n="no"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv.NEG"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="2" side="tl" part="tags"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="to">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="2">
		<lit v="to"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="inf">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>               
	    </lu>  
	  </chunk>
	</out>   
      </action>
    </rule>



 <rule comment="REGLA: ADV PROCLÍTIC VERB conjugat (no el veig) MG: aquí no he posat lo de 'no lo hubo' perquè és molt més freqüent que la següent paraula sigui desconeguda. només es mira si és 'hay'">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/>
	<pattern-item n="hay_lex"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
	<let>
	  <clip pos="3" side="tl" part="lem"/>
	  <get-case-from pos="3">
	    <lit v="be"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="3" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<call-macro n="conj_haverhi">
	  <with-param pos="3"/>
	</call-macro> 
	<out>
	  <chunk namefrom="lema_SV"  case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><var n="pers_chunk"/></tag>
	      <tag><var n="nbr_chunk"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="2">
		<lit v="there"/> 
	      </get-case-from>
	      <lit-tag v="adv"/>
	    </lu>
	    <b/>
	    <lu>
	      <var n="verbfinal"/> 
	    </lu>		  
	  </chunk>
	  <b pos="2"/>
	  <chunk name="pro">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
 </rule>


    <rule comment="REGLA: ADV PROCLÍTIC (lo/la) pasar bien (no lo paso bien) - regla lexicalizada antes de la correspondiente regla general">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro_lola"/>
	<pattern-item n="verb_pronlex"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  	 
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
      </action>
    </rule>


    <rule comment="REGLA: ADV PROCLÍTIC (lo/la) pasar bien (no lo paso bien) - regla lexicalizada antes de la correspondiente regla general">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/>
	<pattern-item n="pro_lola"/>
	<pattern-item n="verb_pronlex"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  	 
	<call-macro n="conj_verb1">
	  <with-param pos="4"/>
	</call-macro>
	<out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="4" side="tl" part="pers"/></tag>
		  <tag><clip pos="4" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="4" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	      <!--<with-param pos="4"/>--> <!-- FMT: només té dos parametres -->
	    </call-macro>
      </action>
    </rule>

    <rule comment="REGLA: ADV PROCLÍTIC VERB conjugat (no el veig)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  

<!--	<choose>
	  <when>
	    <test>
	     <and>
		<equal>
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="3"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu>		  
	      </chunk>
	      <b pos="2"/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </when> -->
<choose>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/>
		  </lu>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem el blanc -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise><!--Si no és separable...-->
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <choose><!--I ara que ja hem imprès el verb, mirem els proclítics (si no és haver-hi) -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/>
			<lit v="se"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
	          <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		      <when>
			<test>
			  <equal caseless="yes">
			    <clip pos="2" side="sl" part="lem"/>
			    <lit v="se"/>
			  </equal>
			</test>
			<let>
			  <var n="lema"/>
			  <lit v="ref"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="ref"/>
			</let>
		      </when>
		      <otherwise>
			<let>
			  <var n="lema"/>
			  <lit v="pro"/>
			</let>
			<let>
			  <var n="nom_chunk"/>
			  <lit-tag v="SN"/>
			</let>
			<choose>
			  <when>
			    <test>
			      <in caseless="yes">
				<clip pos="3" side="sl" part="lem"/>
				<list n="añadir_prep_pron"/>
			      </in>
			    </test>
			    <let>
			      <var n="prepo"/>
			      <concat>
				<get-case-from pos="2">
				  <lit v="for"/>
				</get-case-from>
				<lit-tag v="pr"/>
			      </concat>
			    </let>
			    <out>
			      <b/>
			      <chunk name="pr">
				<tags>
				  <tag><lit-tag v="PREP"/></tag>
				</tags>
				<lu>
				  <var n="prepo"/>
				</lu>
			      </chunk>
			    </out>
			  </when>
			  <otherwise>
			    <let>
			      <var n="prepo"/>
			      <lit v=""/>
			    </let>
			  </otherwise>
			</choose>		
		      </otherwise>
		    </choose>	
		    <out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose> 
	  </otherwise>
	</choose>
      </action>
    </rule>



    <rule comment="NO VERB + ENCL (no ajudar-me - not to help me) (posar-ho en gerundi en anglès?)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbnm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="to_verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags> 
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <get-case-from pos="2">
		    <lit v="to"/>
		  </get-case-from>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>		           
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <in caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <list n="añadir_prep_pron"/>
		  </in>
		</test>
		<let>
		  <var n="prepo"/>
		     <concat>
		       <lit v="for"/>
		       <lit-tag v="pr"/>
		     </concat>
		</let>
		<let>
		  <var n="espai"/>
		  <lit v=" "/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="to_verb_pr_enc"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="prepo"/>
		  <lit v=""/>
		</let>
		<let>
		  <var n="espai"/>
		  <lit v=""/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="to_verb_enc"/>
		</let>
	      </otherwise>
	    </choose>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="sl" part="temps"/></tag>
		</tags> 
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <get-case-from pos="2">
		    <lit v="to"/>
		  </get-case-from>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/> 	           
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <var n="prepo"/>
		</lu>
		<var n="espai"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>



    <rule comment="NO VERB + ENCL + ENCL (no portar-me'ls - not to bring them to me)(en gerundi?)">
      <pattern>
	<pattern-item n="no"/> 
	<pattern-item n="verbnm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/>
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="sep"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="2" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/>
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="sep"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>		           
			<clip pos="2" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <get-case-from pos="3">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="NO + VERBMOD + ENCL + INF (no poder-ho fer - not being able to do it)(aquí ho he posat en gerundi, en els altres casos d'infinitiu negat no, revisar)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>               	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>   
	    <out>
	      <chunk name="no_mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>      
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="3"/>
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/>      
		    <clip pos="4" side="tl" part="a_verb"/>    
		    <clip pos="4" side="tl" part="sep"/>
		    <clip pos="4" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>      
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="no_mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>      
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/>      
		  <clip pos="4" side="tl" part="a_verb"/>    
		  <clip pos="4" side="tl" part="sep"/>
		  <clip pos="4" side="tl" part="temps"/>      
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>  
      </action>
    </rule>

    <rule comment="NO + VERBMOD + ENCL + ENCL + INF (no poder-los-ho explicar -> not being able to explain it to them)">
      <pattern>
	<pattern-item n="no"/> 
	<pattern-item n="verbm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="5" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>  
		<out>
		  <chunk name="no_mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>      
			<clip pos="5" side="tl" part="a_verb"/>   
			<clip pos="5" side="tl" part="sep"/>
			<clip pos="5" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>     
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="no_mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>      
		      <clip pos="5" side="tl" part="a_verb"/>     
		      <clip pos="5" side="tl" part="sep"/>
		      <clip pos="5" side="tl" part="temps"/>      
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="5" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    
		<out>
		  <chunk name="no_mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>      
			<clip pos="5" side="tl" part="a_verb"/>    
			<clip pos="5" side="tl" part="sep"/>
			<clip pos="5" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>     
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="no_mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>      
		      <clip pos="5" side="tl" part="a_verb"/>    
		      <clip pos="5" side="tl" part="sep"/>
		      <clip pos="5" side="tl" part="temps"/>    
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="3">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>


    <rule comment="NO + VERBMOD + ENCL (per quan va davant desconegudes, perquè almenys no peti: no poder-ho xxx - not being able to it xxx)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>	  
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_mod_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>      
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>	  
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


    <rule comment="NO + VERBMOD + ENCL + ENCL (per quan va davant desconegudes, perquè almenys no peti: no poder-los-ho xxx - not being able to them it xxx)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>	  
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_mod_enc_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>    
      </action>
    </rule>

    <rule comment="REGLA: NO + INF (no jugar - not playing)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/> 
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: NO + GER (no fent - not doing)">
      <pattern>
	<pattern-item n="no"/> 
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lemh"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="no_ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>
    
    <rule comment="REGLA: PREP el NUM de MES de NUM (desde el 27 de diciembre de 2002- from 27 December 2002)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="el"/>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mes"/>
	<pattern-item n="de"/>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  	  
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="el_num_de_mes_de_ano">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="tags"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>     
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b pos="6"/>
	    <lu>     
	      <clip pos="7" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>  
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>  
	<call-macro n="f_bcond">
	  <with-param pos="5"/>
	  <with-param pos="6"/>
	</call-macro>  
      </action>
    </rule>

    <rule comment="REGLA: el NUM de MES de NUM  (el 27 de diciembre de 2002 - On 27 December 2002)">
      <pattern>
	<pattern-item n="el"/>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mes"/>
	<pattern-item n="de"/>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  	  
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="on"/>
	      </get-case-from>
	      <lit-tag v="adv"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="el_num_de_mes_de_ano">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="tags"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>     
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b pos="5"/>
	    <lu>     
	      <clip pos="6" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>  
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>  
      </action>
    </rule>

    <rule comment="REGLA: NUM de MES de NUM (27 de diciembre de 2002 - 27 December 2002)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mes"/>
	<pattern-item n="de"/>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="num_de_mes_de_ano" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="3"/>
	    <lu>     
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>  
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>  
      </action>
    </rule>

    <rule comment="REGLA: PREP el NUM de MES (desde el 27 de diciembre - from 27 December)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="el"/>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mes"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  	  
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="el_num_de_mes">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="tags"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>     
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>  
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>  
      </action>
    </rule>

    <rule comment="REGLA: el NUM de MES (el 27 de diciembre - On 27 December)">
      <pattern>
	<pattern-item n="el"/>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mes"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  	  
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="on"/>
	      </get-case-from>
	      <lit-tag v="adv"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="el_num_de_mes">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="tags"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>     
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>  
      </action>
    </rule>

    <rule comment="REGLA: NUM de MES (27 de diciembre - 27 December)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mes"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="num_de_mes" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>  
      </action>
    </rule>

    <!--************************************ ALTRES ************************************************ -->

    <rule comment="ADV">
      <pattern>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="whole"/>
	    </let>
	    <append n="paraula1">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test> 
	      <in caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<list n="adv_intercalados"/>
	      </in>
	    </test>
	    <let>
	      <var n="lema"/>
	      <lit v="adv-interc"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema"/>
	      <lit v="adv"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="1" side="tl" part="neg"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

<rule comment="ADV ITG">
      <pattern>
	<pattern-item n="advitg"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>


<rule comment="PRONOM tònic/interrogatiu/possessiu"> 
      <pattern>
	<pattern-item n="tn_itg_pos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prn" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="PRN personal">
      <pattern>
	<pattern-item n="prpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prpers" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>  
	      <clip pos="1" side="tl" part="a_prn"/>  
	      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    
  <rule comment="PREP PRN personal (amb ell = with him (prn obj))">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="prpers_tn"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="tipus_prn"/> 
	  <lit-tag v="obj"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="pers"/> 
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/> 
		  <lit-tag v="pl"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="mf"/><!--ells/elles = them (mf)-->
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="prpers">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/>  
	      <clip pos="2" side="tl" part="a_prn"/>  
	      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="2" side="tl" part="pers"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    

  <rule comment="PREP relatiu (amb el que)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="el_que"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="prepo"/>
	  <clip pos="1" side="sl" part="lem"/>
	</let>
	<let>
	  <var n="lema"/>
	  <clip pos="2" side="sl" part="lem"/>
	</let>
	<out>
	  <chunk namefrom="prepo" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk namefrom="lema">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_rel"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="2">
		<lit v="which"/>
	      </get-case-from>
	      <lit-tag v="rel.an.mf.sp"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>
    

 <rule comment="CNJ">
      <pattern>
	<pattern-item n="cnj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="que"/>
              </equal>
            </test>
	    <out>
	      <chunk name="que" case="caseFirstWord">
	        <tags>
	          <tag><clip pos="1" side="tl" part="tags"/></tag>		
	        </tags>
	        <lu>
	          <clip pos="1" side="tl" part="whole"/>
	        </lu>
	      </chunk>
	    </out>
          </when>
          <otherwise>
	    <out>
	      <chunk name="cnj" case="caseFirstWord">
	        <tags>
	          <tag><clip pos="1" side="tl" part="tags"/></tag>		
	        </tags>
	        <lu>
	          <clip pos="1" side="tl" part="whole"/>
	        </lu>
	      </chunk>
	    </out>
          </otherwise>
        </choose>
      </action>
    </rule>

<rule comment="por ello + sent">
      <pattern>
	<pattern-item n="porello"/>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="for"/>
	      </get-case-from>
	      <lit-tag v="pr"/>
	    </lu>
	  </chunk>
	  <b/>
	  <chunk name="prn">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><lit-tag v="tn"/></tag>
	      <tag><lit-tag v="mf"/></tag>
	      <tag><lit-tag v="sg"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="that"/>
	      </get-case-from>
	      <lit-tag v="prn.tn"/>
	      <lit-tag v="3"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
</rule>



<!--
 <rule comment="de"> ahora queda incluida en la regla siguiente
      <pattern>
	<pattern-item n="de"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="de" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule> -->


    <rule comment="PREP">
      <pattern>
	<pattern-item n="prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="lema"/>
	  <clip pos="1" side="sl" part="lem"/>
	</let>
	<out>
	  <chunk namefrom="lema" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


  <rule comment="REL"><!--a lo mejor habría que cambiar lema del chunk también para 'el que' y 'el cual', para luego aplicar la rgla del t2x de generación de sujeto tras ciertos relativos -->
      <pattern>
	<pattern-item n="rel"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="lema"/>
	  <clip pos="1" side="sl" part="lem"/>
	</let>	
	<out>
	  <chunk namefrom="lema" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_rel"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



  <rule comment="PREADV">
      <pattern>
	<pattern-item n="preadv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="preadv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



<rule comment="REGLA: NP cognom">
      <pattern>
	<pattern-item n="cog"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="cog" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



<rule comment="REGLA: NP altres">
      <pattern>
	<pattern-item n="al"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="al" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


<rule comment="REGLA: NUM">
      <pattern>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>





    <rule> <!-- REGLA: reset variables-->
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>	      
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
  <rule comment="REGLA: reset variables">
      <pattern>
	<pattern-item n="coma"/>
      </pattern>
      <action>
<!--	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let> -->
        <let>
	  <var n="EOS"/>
	  <lit v="false"/>
	</let>
	<out>
	  <chunk name="coma">
	    <tags>
	      <tag><lit-tag v="cm"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
  </rule>


  </section-rules>
</transfer>
